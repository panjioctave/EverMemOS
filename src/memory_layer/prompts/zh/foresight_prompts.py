"""
前瞻联想预测提示词模板

用于生成基于MemCell和对话转写内容的前瞻联想预测
"""

FORESIGHT_GENERATION_PROMPT = """
你是一个高级个人语义分析智能体。你的任务是基于用户的最新MemCell事件，联想预测该事件可能对该用户个人未来行为、习惯、决策和生活方式产生的具体影响。

## 任务目标：
1. **个人层面联想**：从用户个人角度分析事件对其未来行为、思维模式、生活习惯或决策偏好的潜在影响。
2. **联想预测而非总结**：基于事件内容，联想可能发生的个人变化，而不是重复或总结原文内容。
3. **场景风格匹配**：预测内容必须符合事件发生的场景风格：
   - 生活场景（如健康、家庭、休闲、学习）→ 使用生活化用词，关注个人习惯、情感状态、生活方式、个人成长等
   - 工作场景（如职业发展、技能提升、工作方式）→ 使用工作化用词，关注职业规划、能力提升、工作习惯、专业发展等
4. **个人行为导向**：每条联想应反映用户个人的"可能变化"或"行为偏向"，聚焦个体层面的未来发展。
5. **时间维度合理**：每条预测应包含合理的时间维度，结合事件类型和个人状态推断持续时间。
6. **具体可操作**：每条预测不超过40字，最多生成10条，建议生成4-8条，内容具体且可验证。
7. **人名优先**：输出中优先使用user_name（如"小明"）；如未提供user_name则使用user_id（如user_1），避免用"用户"泛称。
8. **语义关联性**：联想内容应与原事件保持语义关联，通过evidence字段存储原始事实，确保能追溯事件来源。

## 输出格式：
以JSON数组返回结果，每个联想包含时间信息和证据：
[
  {{
    "content": "小明未来一周会避免辛辣和过热食物",
    "evidence": "医生医嘱：忌辛辣过热；未来一周注意口腔清洁",
    "start_time": "2025-10-21",
    "end_time": "2025-10-28",
    "duration_days": 7
  }},
  ...
]

## 示例输入（生活场景）：
- user_id: xiaoming-001
- user_name: 小明
- conversation:
```text
[2025-10-21T14:05:00Z] 小明: 拔牙过程还好，就是现在有点疼。
[2025-10-21T14:06:10Z] 医生: 未来一周注意口腔清洁，避免辛辣和过热食物，肿痛加重就复诊。
[2025-10-21T14:07:30Z] 小明: 明白，我会按医嘱来。
```

## 示例输出（生活场景）：
[
  {{
    "content": "小明未来一周会避免辛辣和过热食物",
    "evidence": "医生医嘱：忌辛辣过热；未来一周注意口腔清洁",
    "start_time": "2025-10-21",
    "end_time": "2025-10-28",
    "duration_days": 7
  }},
  {{
    "content": "小明未来一周会更注意口腔清洁",
    "evidence": "医生医嘱：未来一周注意口腔清洁",
    "start_time": "2025-10-21",
    "end_time": "2025-10-28",
    "duration_days": 7
  }},
  {{
    "content": "小明若肿痛加重会尽快复诊",
    "evidence": "医生提示：肿痛加重需复诊",
    "start_time": "2025-10-21",
    "end_time": "2025-11-04",
    "duration_days": 14
  }},
  {{
    "content": "小明这几天会减少用力咀嚼",
    "evidence": "术后疼痛（小明说现在有点疼）",
    "start_time": "2025-10-21",
    "end_time": "2025-10-25",
    "duration_days": 4
  }}
  ...
]

## 示例输入（工作场景）：
- user_id: LiHua-001
- user_name: 李华
- conversation:
```text
[2025-10-21T10:00:00Z] 培训师: 今天我们将讨论敏捷规划和冲刺仪式。
[2025-10-21T11:15:20Z] 李华: 日常站会结构更清晰了，我可以应用到我的团队。
[2025-10-23T16:40:05Z] 培训师: 回顾指标和改进团队协作。
```

## 示例输出（工作场景）：
[
  {{
    "content": "李华未来两周会在团队试行更规范的站会",
    "evidence": "李华认为站会结构更清晰，准备应用到团队",
    "start_time": "2025-10-21",
    "end_time": "2025-11-04",
    "duration_days": 14
  }},
  {{
    "content": "李华未来一个月会尝试推动冲刺仪式落地",
    "evidence": "培训内容包含敏捷规划与冲刺仪式",
    "start_time": "2025-10-21",
    "end_time": "2025-11-21",
    "duration_days": 31
  }},
  {{
    "content": "李华下次迭代后会尝试回顾指标并复盘",
    "evidence": "培训师强调迭代后回顾指标并复盘协作",
    "start_time": "2025-10-21",
    "end_time": "2025-11-21",
    "duration_days": 31
  }},
  {{
    "content": "李华未来一个月会更关注协作改进动作",
    "evidence": "培训强调持续改进团队协作",
    "start_time": "2025-10-21",
    "end_time": "2025-11-21",
    "duration_days": 31
  }}
  ...
]

## 注意事项：
- **个人导向**：聚焦用户"个人层面的未来变化"，内容可涵盖生活、学习、工作、情绪、习惯等个人发展。
- **联想创新**：不要重复原文内容，要生成事件可能引发的个人行为、习惯或决策变化。
- **场景适配**：语言风格必须与事件场景匹配，生活场景用生活化表达，工作场景用工作化表达。
- **时间推断**：结合事件类型、个人状态和常识合理推断时间范围，不要生硬套用固定时间。
- **内容实用**：内容必须具体、合理、实用，能被系统用于个人前瞻建模。
- **语义检索友好**：content应是联想预测的结果（如"会选择软质食物"），evidence保存原始事实（如"拔除智齿"），便于AI根据用户查询（如"推荐食物"）检索相关前瞻并追溯原因。
- **时间信息提取规则：**
  - start_time: 从输入内容中提取事件发生的具体日期（通常在summary或episode中），格式为YYYY-MM-DD
  - end_time: 从原文内容中提取具体的结束时间点，如果原文中有明确的结束时间（如"10月24日前"、"2025-11-15"等），则提取具体日期，否则结合事件内容和常识合理推断
  - duration_days: 从原文内容中提取持续时间，如果原文中有明确的时间描述（如"一周内"、"7天"、"一个月"等），则提取天数，否则结合事件内容和常识合理推断
  - evidence: 用1-2句话对支撑该预测的关键事实做可溯源总结（可合并多句对话/摘要信息），不得引入原文没有的新事实，建议不超过60字
  - **重要**：优先从原文中提取明确的时间信息，如果没有则结合事件内容和常识进行合理推断，时间不能为null

## 输入（Markdown）：
说明：你将收到以下 Markdown 结构：
- user_id: {USER_ID}
- user_name: {USER_NAME}
- conversation:
```text
{CONVERSATION_TEXT}
```

## 请基于以上内容，生成4-8条（最多10条）对用户未来生活、决策可能产生影响的联想：

"""
